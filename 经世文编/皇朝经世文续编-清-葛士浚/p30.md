<!-- { "loadSidebar": true } -->
四元之术至明而失其传近得徐钧卿罗茗香诸公相继阐发始有蹊径可寻然按法求之恒苦其难而不适于用约其大端盖有三焉天物相乘与地人相乘并用寄位则幂与幂乘推而上之几有无方位置之处一也剔消之法以一式截分为二左右斜正初无一定之规非熟于法者安能无误二也次式副式通式及上中下诸式之名任意作记易滋学者之疑三也繙阅之暇每欲改易算式而其道无由乙已冬海甯李君秋纫以所着四元解示余余受而读之见其以面体释四元以面体之自乘再乘定算式而相消所得直命为初消次消三消则向所难之三事均已无之作而叹曰心之神明固若是之日出而不穷乎非四元无以尽天元之变非天元无以尽少广之变而非少广之面体则亦无以定四元之位而直　发明其所以然窃为一言以蔽之曰析堆垛成广隅而已古法置太极于中心而环之以八又环之以十六其递增也皆以八堆垛之式也新法置太极于一隅而附之以三又附之以五其递增也皆以二廉隅之象也置太极于中心则上下左右动有牵制置太极于一隅则升降进退无往不宜由是四元相乘皆有位无寄位也四元为法皆可除无剔消也且其定位之图既化诸乘方为平方相乘相消之图又化诸乘方为立方反覆辨论均能假象以达难显之情何李君之心曲而善入如此李君又有弧矢启秘对数探原诸书皆本天元之术而引而伸之实发前人所未发余冀其悉合而传之以为言算者一大快也
　　对数探原序　　　
顾观光
对数探原者海甯李君秋纫所着也西人对数之表以加减代乘除用之甚易而造之甚难李君巧借诸乘尖堆以定其数又化诸乘尖堆为同高同底之平尖堆以图其形由是递加递除而诸对数指顾可得精思所到生面独开矣究其立法之原不越乎天元以虚求实之理是故尖堆之底即天元也尖堆之高即正数也平分其高为若干分依分各作横以截其积而对数之法由之以生何也对数之首位自一至九止矣一之对数为而百亿之对数亦为故尖堆下段之积不可求而总积亦不可求非无积也正以其大之极而一至九之数不足以名故反命为此盈虚消息如环无端之妙也二至十之共积为一十一至一百之共积为一一百一至一千之共积亦为一推之至于万亿无不如是此尖堆渐上渐狭渐下渐阔之理也以加倍代自乘则二段之积不得不同于三四两段之积以三因代再乘则二段之积不得不又同于五六七八四段之积此尖堆二段以上积数相等之理也尖堆之底无尽积亦与为无尽而求两对数较则所得皆为最上一段之积故二十尖堆已足当亿万尖堆之用西人不达乎此乃用正数屡次开方对数屡次折半以求之亦识流而昧其原矣易不云乎易则易知简则易从李君渺虑凝思无幽不启盖实有以通易简之原而体神明之撰者西人见之应亦自悔其徒劳也
　　数学跋　　　
顾观光
江氏数学继梅氏历书而作者也其于七政运行之故岁实消长之原曲畅旁通实足补梅氏之未备自钱竹汀谓宣城能用西学江氏则为西人所用且极诋其冬至权度如公孙龙之言臧三耳甚难而实非无识者往往惑之平心而论江氏之囿于西法固矣钱氏之说则又囿于中法而非实事求是之学也七政盈缩迟疾之原或曰小轮或曰不同心天世无陵云御风之人谁为正之然使小轮所用止在盈缩迟疾之间则谓其巧算而非真象无不可也无如日月在小轮之上半周则距地远而视之亦小在小轮之下半周则距地近而视之亦大视径有大小即地半径差有损益而影径分之多寡亦由之而殊是七政之有高卑不待盈缩迟疾而后信也有高卑则舍小轮与不同心天固更无他法矣两心差之有大小西人早已言之日躔历指偁意罢阁于汉景帝时测两心差为十万分之四千一百五十一九执历推定日法分一象限为六段计其积差凡二度十四分以正切求两心差得十万分之三千九百江氏推刘宋大明时两心差四三五与意罢阁所测正相近唐开元时冬至减时大于今四刻有奇则较九执历为稍赢耳钱氏谓两心差古大今小仍是杨郭百年消长之法不知消长以定冬至为根而两心差之加减则以平冬至为根根既不同算何由合元明以来岁实由消而渐长议者纷纷江氏妙解算理因授时历议所述丁丑至庚辰四年冬至自相乖违而知其刻下小余有三十分断为长极而消之大界证佐甚明恐善辨者亦难为郭氏解也西法行之已久不能无差江氏之书诚有主持太过之弊然元嘉十三年甲戌冬至诸历皆得癸酉大明五年乙酉冬至诸历皆得甲申而江氏所推独与古人吻合元嘉十八年己亥冬至则据隋志以正宋志之光大二年乙巳冬至则据太建四年丁卯冬至而疑其测验之非真此皆由古籍中参稽而得非徒立异同钱氏考之不审乃以为辞穷而遁是算术不足信而史文必无一字之舛也有是理乎两心差古大今小江氏未有定率而改最卑每岁东行为一分三秒则精思所到遂与噶西尼之新法不约而同可见考诸古而无疑者质诸今而自合若合于古而不合于今则其合也亦幸而已矣易不云乎天地之道贞观者也天有常行不以古今而异谓西人之术必不可以考古是古之天行异于今也谓古之天行异于今是古与今当各有一天也而岂其然哉江氏书世无善本七政小轮诸纷如乱丝恐其久而失传无以为治历者先路之导今特详为校正书中精确不磨之处读者当自知之惟无以是古非今之见先横于中此则余所旦暮遇之也夫
　岁实消长其故有二一由两心差有大小一由黄赤距有远近吴江王氏青州薛氏并尝言之今薛氏天学会通未见足本晓庵新法又脱去补遗不知其说云何江氏之说得其一而失其一盖考之未审矣夫黄极环赤极二万五千八百六十八年而一周即岁差也黄道既退行于赤道则岁实必渐消惟是西人旧说皆以岁差为恒星东行遂与最高行两数混淆无从分析中法知岁差为岁不及天矣而又不知最高之有行分宜乎岁实消长历千余年而未有定论也近日西人新测春秋分点每岁西行五十一秒最高每岁东行十一秒八两心差古大今小约百年差二万五千分之一黄赤道古远今近约百年差四十八秒咸丰庚申最卑过冬至十度二十八分五十三秒三黄赤大距二十三度二十七分二十七秒三八
皇朝经世文续编卷七
　学术七文学三附算学
　　五星岁轮与伏见轮之不同　　　
顾观光
西法步五星土木火用岁轮金水用伏见轮梅勿庵谓五星皆有岁轮而伏见轮即岁轮上星行绕日之圆象婺源江氏从之着金水二星发微绘图立算缕析条分而征之等边等角之两三角形以着其理二家之说可谓详且明矣余尝细译历书而知岁轮与伏见轮之算其不可强同者有四试详言之土木火次引以初实行减太阳实行得之是次引大小一由于太阳之盈缩一由于本天之高卑而金水二星但以初均加减伏见平行不用太阳盈缩差其不同一也土木火以初实行减太阳实行则初均数为加者距日度反差而少初均数为减者距日度反差而多此缘上三星之行迟于太阳故如此立法若金水二星之行速于太阳初均数加则距日度亦加初均数减则距日度亦减而乃反用初均以加减伏见平行与上三星算同而理正相反其不同二也用岁轮则心在本道有升度差用伏见轮则心在黄道无升度差其不同三也土木火以正交行减初实行是用次轮心距正交度金水以正交行减初实行又加伏见实行而初实行与伏见实行相并之度即平行与伏见平行相并之度是从伏见轮言之为星距正交度从本天言之即本轮心距正交度矣其不同四也因此四事而知岁轮与伏见轮之用离之则双美合之则两伤矣然则梅氏江氏之说非乎曰未可非也所不同之四事历书均已言之曰伏见轮虽以太阳为心实以太阳本轮心为心也曰伏见轮最远点无定分其距平远点之度必与初均等也曰伏见轮最远点距伏见轮正交之度必与伏见轮心距本道正交之度等也之三者非征之实测未易决其是非惟谓伏见轮在黄道无升度差则即以伏见轮之理考之而知其必不可通何也伏见轮之心虽行于黄道而其面与黄道斜交半在南半在北惟正交中交二点与黄道合联此二点过心成一直此必与黄道平行而其距伏见轮远近之度时时不等设正交距最远九十度则伏见轮之上下一南一北成偃卧之势谓其无升度差理固然矣若正交与最远合则伏见轮之左右一南一北成侧立之势与土木火本道之斜交于黄道者其象正同又安得无升度差乎斯时黄道如句视纬如股伏见轮面如弦自黄极出抵黄道及星在伏见轮之右者其度必差而东在伏见轮之左者其度必差而西历书概置不论但以本道即黄道一语了之不思经度与纬度相待而成无升度差安得复有视纬此可以理决之不俟实测而后信也要之伏见轮之法本于岁轮自承用者逐影忘形遂至抵牾不合回历五星并用太阳平行并无升度差岁轮与伏见轮通为一法西人于土木火三星屡改益精而金水二星仍同回历由泥于伏见轮在黄道之说而不复深思盖改法者已不知伏见轮为岁轮上星行绕日之圆象矣梅氏江氏之说颖悟绝伦表而出之以告天下后世之读古人书而死于句下者
　　几何原本六和六较解　　　
顾观光
大分四正方十六　小分三四六四奇正方十二　两正方较积四其边二与大分有等　半小分一七三二奇正方三　大分上作少一正方之矩形与半小分正方等长三阔一
大小两分相并得七四六四奇为第一合名第二第三同
　　相减余五三五奇为第一断第二第三同
设有比例八与大分有等　以乘矩形之长得二十四其边四八九八奇以乘矩形之阔得八其边二八二八奇两数相并得七七六奇为合名自之得五九七一奇即第一合名乘比例之矩形两数相减得二七奇为断自之得四二八五奇即第一断乘比例之矩形
设有比例六九二八奇与小分有等以乘矩形之长得二十七八奇其边四五五八奇以乘矩形之阔得六九二八奇其边二六三二奇　两数相并得七一九奇为第一合中自之得五一七一奇即第二合名乘比例之矩形　两数相减得一九二六奇为第一中断自之得三七九奇即第二断乘比例之矩形
设有比例七与大分小分皆无等　以乘矩形之长得二十一其边四五八二奇以乘矩形之阔得七其边二六四五奇　两数相并得七二二七奇为第二合中自之得五二二四奇即第三合名乘比例之矩形　两数相减得一九三七奇为第二中断自之得三七五二奇即第三断乘比例之矩形
大分四一二三奇正方十七　小分三六五奇正方十三　两正方较积四其边二与大分无等　半小分一八二奇正方三二五　大分上作少一正方之矩形与半小分正方等长三六一奇阔一六一奇
大小两分相并得七七二八奇为第四合名第五第六同
　　相减余五一八奇为第四断第五第六同
设有比例八二四六奇与大分有等　以乘矩形之长得二十五二四奇其边五二三奇以乘矩形之阔得八七四九奇其边二九五七奇　两数相并得七九八奇为太自之得六三七二奇即第四合名乘比例之矩形　两数相减得二六六为少自之得四二六八奇即第四断乘比例之矩形
